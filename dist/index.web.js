(function(n){var i={};function s(t){if(i[t]){return i[t].exports}var e=i[t]={i:t,l:false,exports:{}};n[t].call(e.exports,e,e.exports,s);e.l=true;return e.exports}s.m=n;s.c=i;s.d=function(t,e,n){if(!s.o(t,e)){Object.defineProperty(t,e,{enumerable:true,get:n})}};s.r=function(t){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(t,"__esModule",{value:true})};s.t=function(e,t){if(t&1)e=s(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var n=Object.create(null);s.r(n);Object.defineProperty(n,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n};s.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};s.d(t,"a",t);return t};s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};s.p="";return s(s.s=268)})({0:function(t,e){t.exports=React},1:function(t,e){t.exports=ReactDOM},11:function(t,e,n){n(281);var i=n(0);t.exports=i.createClass({displayName:"Link",getDefaultProps:function t(){return{highLightStyle:{stroke:"#f0ad4e",strokeWidth:"1px"},lineStyle:{stroke:"#E26965",strokeWidth:"1px"}}},getInitialState:function t(){return{uuid:this.props.id||zn.uuid(),x1:0,y1:0,x2:0,y2:0,marker:"",lineStyle:this.props.lineStyle,svgStyle:{},zIndex:0}},componentDidMount:function t(){this.highLight(false);this.props.onLinkDidMount&&this.props.onLinkDidMount(this)},setTarget:function t(e){if(e){this._target=e;e.setLink(this.state.uuid,this)}},setSource:function t(e){if(e){this._source=e;e.setLink(this.state.uuid,this)}},getId:function t(){return this.state.uuid},reset:function t(e,n){var i=this.__calculateSVGBound(e,n);if(i){if(i.left==0&&i.top==0){i.width=0;i.height=0}this.setState({svgStyle:i})}},__getDirection:function t(e,n,i,s){var r=0;var e=e-i<=0?e:i;var n=n-s<=0?n:s;if(e!=i&&n!=s){r=1}if(e==i&&n!=s){r=2}if(e==i&&n==s){r=3}if(e!=i&&n==s){r=4}return r},highLight:function t(e){var n={};if(e){n=this.props.highLightStyle}else{n=this.props.lineStyle}this._highLight=e;this.setState({lineStyle:n})},__calculateSVGBound:function t(e,n){var i=e||!!this._target&&this._target.getCenterXY();var s=n||!!this._source&&this._source.getCenterXY();if(!i||!s){return}var r=this.props.minSize||2,a=this.__getDirection(i.x,i.y,s.x,s.y);var o=0,l=0,h=0,c=0;var u=0,p=0,d=0,f=0;switch(a){case 1:o=i.x;l=i.y;h=s.x-i.x;c=s.y-i.y;h<r&&(h=r);c<r&&(c=r);u=0;p=0;d=h;f=c;break;case 2:o=s.x;l=i.y;h=i.x-s.x;c=s.y-i.y;h<r&&(h=r);c<r&&(c=r);u=0;p=c;d=h;f=0;break;case 3:o=s.x;l=s.y;h=i.x-s.x;c=i.y-s.y;h<r&&(h=r);c<r&&(c=r);u=0;p=0;d=h;f=c;break;case 4:o=i.x;l=s.y;h=s.x-i.x;c=i.y-s.y;h<r&&(h=r);c<r&&(c=r);u=0;p=c;d=h;f=0;break}this.setState({x1:u,y1:p,x2:d,y2:f});return{left:o,top:l,width:h,height:c}},drawLineArrow:function t(e,n,i,s){var r;var a,o,l;var h=10;var c,u;a=Math.atan2(n-s,e-i);o=Math.cos(a);l=Math.sin(a);r="M"+e+","+n+" L"+i+","+s;c=(Number(e)+Number(i))/2;u=(Number(n)+Number(s))/2;r+=" M"+c+","+u;r+=" L"+(Number(c)+Number(h*o-h/2*l))+","+(Number(u)+Number(h*l+h/2*o));r+=" M"+(Number(c)+Number(h*o+h/2*l)+","+(Number(u)-Number(h/2*o-h*l)));r+=" L"+c+","+u;return r},render:function t(){return i.createElement("svg",{className:"zr-graph-link",version:"1.1",xmlns:"http://www.w3.org/2000/svg",style:this.state.svgStyle},i.createElement("defs",null,i.createElement("marker",{id:"Triangle",markerWidth:"20",markerHeight:"20",refX:"0",refY:"4",orient:"auto",markerUnits:"strokeWidth",viewBox:"0 0 50 50"},i.createElement("path",{d:"M0,0 L0,6 L9,3 z",fill:"#f00"}))),i.createElement("line",{className:"line",markerStart:"url(#Triangle)",x1:this.state.x1,y1:this.state.y1,x2:this.state.x2,y2:this.state.y2,style:this.state.lineStyle}))}})},268:function(t,e,n){zn.overwrite(zn.react,n(28));zn.overwrite(zn.react,n(29));zn.overwrite(zn.react,n(30));zn.overwrite(zn.react,n(32));t.exports=zn.react},269:function(t,e,n){var i={"./index.js":28};function s(t){var e=r(t);return n(e)}function r(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");e.code="MODULE_NOT_FOUND";throw e}return i[t]}s.keys=function t(){return Object.keys(i)};s.resolve=r;t.exports=s;s.id=269},270:function(t,e,n){var i={"./FilterItem.js":271,"./WebRouter.js":273,"./XlsxImporter.js":275,"./index.js":29};function s(t){var e=r(t);return n(e)}function r(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");e.code="MODULE_NOT_FOUND";throw e}return i[t]}s.keys=function t(){return Object.keys(i)};s.resolve=r;t.exports=s;s.id=270},271:function(t,e,n){function i(){i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){t[i]=n[i]}}}return t};return i.apply(this,arguments)}n(272);var s=n(0);var r={"=":{text:"等于",value:"=",icon:"fa-exchange"},">":{text:"大于",value:">",icon:"fa-angle-right"},"<":{text:"小于",value:"<",icon:"fa-angle-left"},like:{text:"相似",value:"like",icon:"fa-percent"},cancle:{text:"取消",value:"cancle",icon:"fa-remove"}};t.exports=s.createClass({displayName:"FilterItem",getDefaultProps:function t(){return{disabled:true,className:"",opts:[]}},getInitialState:function t(){return{opt:this.props.opt,disabled:this.props.disabled,optIcon:"fa-filter",value:this.props.value,status:"default"}},componentDidMount:function t(){if(this.props.value!=undefined){this.refs.input.setValue(this.props.value)}},validate:function t(){var e=this.refs.input.getValue();if(this.props.required&&!e){this.setState({status:"danger"});return false}else{this.setState({status:"success"})}return e},__onListItemClick:function t(e,n,i){if(e=="cancle"){this.refs.input.setValue("","");this.setState({value:"",optIcon:"fa-filter",disabled:true},function(){this.props.onCancle&&this.props.onCancle(e,n,i,this)}.bind(this))}else{if(e!=this.state.value){this.setState({opt:e,optIcon:n.props.icon,disabled:false},function(){this.props.onOptChange&&this.props.onOptChange(e)}.bind(this))}}zn.popover.close("FilterItem:listitem.click")},__getData:function t(){var n=[];this.props.opts.forEach(function(t,e){if(r[t]){n.push(r[t])}});n.push(r["cancle"]);return n},__listItemRender:function t(e,n){return s.createElement("span",null,s.createElement("i",{style:{width:16,height:16},className:"fa "+e.icon}),e.text)},__popoverRender:function t(){return s.createElement(zn.react.ListView,{itemRender:this.__listItemRender,data:this.__getData(),value:this.state.opt,onItemClick:this.__onListItemClick,style:{border:"none",backgroundColor:"#FFF"}})},render:function t(){var e=null,n=this.props.type;if(zn.is(n,"string")){if(zn.path(window,n)){e=zn.path(window,n)}else{e=zn.react[n]}}else{e=n}return s.createElement(zn.react.RTFlexItem,i({},this.props,{className:"zr-filter-item "+this.props.className+" "+this.state.status+" "+(this.props.fullWidth?"full":"")}),s.createElement(zn.react.Dropdown,{className:"filter-dropdown",popoverRender:this.__popoverRender,popoverWidth:this.props.popoverWidth},s.createElement("i",{className:"filter-icon fa "+this.state.optIcon})),e&&s.createElement(e,i({ref:"input"},this.props,{disabled:this.state.disabled,value:this.state.value,className:"filter-input"})))}})},272:function(t,e){},273:function(t,e,n){n(274);var a=Object.prototype.toString;var i=n(0);var s=i.createClass({displayName:"WebRouter",getInitialState:function t(){return{view:null,argv:null}},componentDidMount:function t(){zn.react.session.setHome(this.props.home).setGlobalSearch(this.props.search);this._handler=new zn.react.RestfulHandler;this.__initMapping(this.props.routers)},__parseRouters:function t(e){var n=null,i=null,s=e["/"];for(var r in e){i=e[r];n=(e.$PREFIX||"")+r;if(r=="/"){n=n+"{*}";this._mappings[n]={index:i,mapping:"{*}",path:n};continue}switch(a.call(i)){case"[object Function]":this._mappings[n]={index:s,mapping:r,path:n,view:i};break;case"[object Object]":i.$PREFIX=n;this.__parseRouters(i);break}}},__initMapping:function t(e){var n=this,i=null,s=null;this._historys=[];this._mappings=e;this.__parseRouters(e);this._handler.error(function(t){if(n.props.home&&!t.path){zn.react.session.jump(n.props.home)}else{n.setState({view:zn.react.ErrorPage,argv:{request:t}})}});var r=this._mappings;for(var a in r){s=r[a];(function(t,e){n._handler.get(t,function(t){i=e.index||e.view;if(e.index){e=r[t.path]}if(n.state.view===e.view){if(e.mapping=="{*}"){return false}return false}e.request=t;n._historys.push(e);n.setState({view:i,argv:e})})})(a,s)}this._handler.fireHashChange()},render:function t(){return i.createElement("div",{className:zn.react.classname("zr-url-router",this.props.className)},this.state.view&&i.createElement(this.state.view,this.state.argv))}});t.exports=s},274:function(t,e){},275:function(t,e,n){function i(){i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){t[i]=n[i]}}}return t};return i.apply(this,arguments)}n(276);var s=n(0);t.exports=s.createClass({displayName:"exports",getInitialState:function t(){var e=this.props.hiddens||{};if(!this.props.editable){zn.overwrite(e,{model:this.props.model,fields:this.props.fields})}return{value:"",hiddens:e,data:[]}},__onChange:function t(e){var n=e[0];this.setState({value:n.name});if(n.name.indexOf("xls")==-1){return(zn.notification.error||window.alert).call(null,"文件["+n.name+"]不是 xlsx / xls 类型"),false}if(!this.props.action){return(zn.notification.error||window.alert).call(null,"The action is empty"),false}if(this.props.editable){return{model:this.refs.model.refs.input.getValue(),fields:this.refs.fields.refs.input.getValue()}}},__onComplete:function t(e,n){this.setState({data:e});this.props.onComplete&&this.props.onComplete(e,n)},getValue:function t(){return this.state.value},setValue:function t(e){this.setState({value:e})},__renderEditer:function t(){if(this.props.editable){return s.createElement("div",null,s.createElement(zn.react.FormItem,{ref:"model",value:this.props.model,title:"Model:",type:"Input"}),s.createElement(zn.react.FormItem,{ref:"fields",value:this.props.fields,title:"Fields:",type:"Input"}))}},__renderSheet:function t(e){var n=e.data,i=n.shift();if(!i){return null}i=i.map(function(t){return{title:t}});return s.createElement(zn.react.Table,{items:i,showHeader:true,data:n})},__renderTables:function t(){if(this.state.data.length){return s.createElement("ul",{className:"xlsx-importer-list"},this.state.data.map(function(t,e){return s.createElement("li",{key:e},s.createElement(zn.react.Card,{title:t.title},this.__renderSheet(t)))}.bind(this)))}},__onError:function t(e){zn.notification.error("Import Error: "+e);this.props.onError&&this.props.onError(e)},render:function t(){return s.createElement("div",{className:"zr-xlsx-importer"},s.createElement(zn.react.AjaxUploader,i({},this.props,{hiddens:this.state.hiddens,className:"xlsx-importer-uploader",onChange:this.__onChange,onError:this.__onError,onComplete:this.__onComplete,multipart:false}),s.createElement("div",{className:"container"},s.createElement("i",{className:"fa fa-file-excel-o"}),this.state.value)),this.__renderEditer(),this.__renderTables())}})},276:function(t,e){},277:function(t,e,n){var i={"./FlowCanvas.js":278,"./Link.js":11,"./Node.js":31,"./index.js":30};function s(t){var e=r(t);return n(e)}function r(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");e.code="MODULE_NOT_FOUND";throw e}return i[t]}s.keys=function t(){return Object.keys(i)};s.resolve=r;t.exports=s;s.id=277},278:function(t,e,n){function r(){r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){t[i]=n[i]}}}return t};return r.apply(this,arguments)}n(279);var a=n(0);var i=n(1);var o=n(31);var s=n(11);t.exports=a.createClass({displayName:"FlowCanvas",getInitialState:function t(){return{nodes:[],links:[]}},componentDidMount:function t(){this._dom=i.findDOMNode(this);this.setData(this.props.data);this.__initDragDrop(this._dom)},componentDidUpdate:function t(e,n){if(e.data!=this.props.data){this.setData(this.props.data)}},__initDragDrop:function t(e){e.ondragover=function(t){t.preventDefault();this.props.onDragOver&&this.props.onDragOver(t);return true}.bind(this);e.ondragenter=function(t){this.props.onDragEnter&&this.props.onDragEnter(t);return true}.bind(this);e.ondrop=function(t){this.props.onDrop&&this.props.onDrop(t,JSON.parse(t.dataTransfer.getData("data")||"{}"));return false}.bind(this)},__onNodeDidMount:function t(e){this._nodes[e.getId()]=e},__onNodeDrag:function t(){},__onNodeDragEnd:function t(e,n,i){var s=this.state.nodes[i.props.index];if(s){s.x=n.currX;s.y=n.currY;this.props.onNodeDragEnd&&this.props.onNodeDragEnd(e,n,i)}},__onLinkDidMount:function t(e){var n=this._nodes[e.props.target],i=this._nodes[e.props.source];this._links[e.getId()]=e;e.setTarget(n);e.setSource(i);e.reset()},getData:function t(){return{nodes:this.state.nodes,links:this.state.links}},setData:function t(e){if(e){var n={};if(e.nodes){n.nodes=e.nodes}if(e.links){n.links=e.links}if(Object.keys(n).length){this._nodes={};this._links={};this.setState(n)}}return this},addLink:function t(e,n){this.state.links.push({target:e,source:n});this.forceUpdate()},deleteLink:function t(e){this.state.links.splice(this.state.links.indexOf(e),1);this.forceUpdate()},updateNode:function t(n){this.state.nodes.map(function(t,e){if(n===t){return n}return t});this.forceUpdate()},addNode:function t(e,n){e.id=zn.uuid();this.state.nodes.push(e);if(n){this.state.links.push({target:e.id,source:n.getId()})}this.forceUpdate()},deleteNodeById:function t(n){var i=null;this.state.nodes=this.state.nodes.filter(function(t,e){if(t.id!==n){return true}else{i=t.id;return false}});if(i){this.state.links=this.state.links.filter(function(t,e){if(t.source==i||t.target==i){return false}else{return true}})}this.forceUpdate()},updateNodeById:function t(n,i){this.state.nodes.forEach(function(t,e){if(t.id===n){zn.extend(t,i)}});this.forceUpdate()},deleteNode:function t(e){this.state.nodes.splice(this.state.nodes.indexOf(e),1);this.forceUpdate()},filterNode:function t(e){this.setState({nodes:this.state.nodes.filter(e||function(){})})},searchNode:function t(e){if(!this.__nodes){this.__nodes=this.state.nodes.slice(0)}this.setState({nodes:this.__nodes.filter(e)})},__onNodeClick:function t(e,n,i){this.setState({selectNode:i});this.props.onNodeClick&&this.props.onNodeClick(e,n,i,this)},render:function t(){zn.debug("FlowCanvas data: ",this.state);return a.createElement("div",{className:zn.react.classname("zr-graph-flow-canvas",this.props.className)},(this.state.nodes||[]).map(function(i,t){var s=this;i.id=i.id||zn.uuid();return a.createElement(o,r({},i,{key:i.id,index:t,canvas:this,className:this.props.nodeClassName,selected:this.state.selectNode===i?true:false,editable:this.props.editable||i.editable,draggable:this.props.draggable||i.draggable,render:this.props.nodeRender,onContextMenu:this.props.onNodeContextMenu,onNodeEditDragEnd:this.props.onNodeEditDragEnd,onNodeDidMount:this.__onNodeDidMount,onNodeDrag:this.__onNodeDrag,onNodeDragEnd:this.__onNodeDragEnd,onClick:function t(e,n){return s.__onNodeClick(e,n,i)}}))}.bind(this)),this.state.links.map(function(t,e){t.id=t.id||zn.uuid();return a.createElement(s,r({},t,{key:t.id,render:this.props.linkRender,onLinkDidMount:this.__onLinkDidMount}))}.bind(this)),a.createElement(s,{ref:"temp"}))}})},279:function(t,e){},28:function(t,e,n){t.exports=zn.arrayValueToObject([],function(t,e){return n(269)("./"+t+".js")})},280:function(t,e){},281:function(t,e){},282:function(t,e,n){var i={"./EditableTable.js":283,"./Table.js":284,"./TableBody.js":35,"./TableColgroup.js":37,"./TableFilter.js":34,"./TableHeader.js":33,"./TableRow.js":36,"./index.js":32};function s(t){var e=r(t);return n(e)}function r(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");e.code="MODULE_NOT_FOUND";throw e}return i[t]}s.keys=function t(){return Object.keys(i)};s.resolve=r;t.exports=s;s.id=282},283:function(t,e,n){function i(){i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){t[i]=n[i]}}}return t};return i.apply(this,arguments)}var o=n(0);t.exports=o.createClass({displayName:"exports",getDefaultProps:function t(){return{headers:[],data:[]}},getInitialState:function t(){return{}},componentDidMount:function t(){this._tableBody=this.refs.dstable.refs.body},getValue:function t(){return this._tableBody.getData()},setValue:function t(e){this._tableBody.setData(e)},getText:function t(){},__onRowAdd:function t(){this._tableBody.insertRow({_editable:true})},__onRowDelete:function t(e,n,i,s,r){console.log("delete",i);this._tableBody.deleteRow(i)},__onRowAppend:function t(e,n,i,s,r){console.log("append",i);this._tableBody.insertRow({_editable:true},e)},__tableHeaderRender:function t(e,n,i){if(n==0){return o.createElement("div",{style:{textAlign:"center"}},o.createElement(zn.react.Icon,{tooltip:"Add Row(Insert Last Row)",icon:"fa-plus",onClick:this.__onRowAdd}))}},__tableColumnRender:function t(e,n,i,s,r){var a=this;if(s.type=="action"){return o.createElement("div",{style:{textAlign:"center"}},o.createElement(zn.react.Icon,{tooltip:"Delete Row(Delete This Row)",icon:"fa-minus",onClick:function t(){return a.__onRowDelete(e,n,i,s,r)}}))}},render:function t(){return o.createElement(zn.react.Table,i({ref:"dstable"},this.props,{singleSelect:false,editable:true,enableFilter:false,checkbox:false,showHeader:true,items:[{title:"Actions",name:"Actions",type:"action",width:50,textAlign:"center"}].concat(this.props.headers),data:this.props.data,headerRender:this.__tableHeaderRender,columnRender:this.__tableColumnRender}))}})},284:function(t,e,n){function i(){i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){t[i]=n[i]}}}return t};return i.apply(this,arguments)}n(285);var s=n(0);var r=n(33);var a=n(35);var o=n(37);t.exports=s.createClass({displayName:"Table",getDefaultProps:function t(){return{items:[],fixed:false,className:""}},getInitialState:function t(){return{searchWhereKeys:[]}},__onHeaderCheckBoxChange:function t(e){this.refs.body.checkedAll(e)},__onBodyCheckBoxChange:function t(e,n,i){this.props.onBodyCheckBoxChange&&this.props.onBodyCheckBoxChange(e,n,i,this)},__onFilter:function t(e,n){if(Object.keys(e).length){var i=this.props.data._data.where||{},s=null,r=null;this.state.searchWhereKeys.map(function(t,e){i[t]=null;delete i[t]}.bind(this));this.state.searchWhereKeys=[];zn.each(e,function(t,e){s=e+"&"+t.opt;r=t.value;if(r!==null&&r!=""){i[s]=r;this.state.searchWhereKeys.push(s)}else{i[s]=null;delete i[s]}}.bind(this));this.props.onFilter&&this.props.onFilter();this.props.data._data.pageIndex=1;if(Object.keys(i).length){this.props.data._data.where=i}else{this.props.data._data.where=null;delete this.props.data._data.where}this.props.data.exec()}},getCheckedItems:function t(e){return this.refs.body.getCheckedItems(e)},setData:function t(e,n){this.refs.body.setData(e,n)},insertRow:function t(e,n){this.refs.body.insertRow(e)},refresh:function t(){this.refs.body.refresh()},getValue:function t(){return this.refs.body.getValue()},setValue:function t(e){this.refs.body.setValue(e)},render:function t(){var e=this.props.items.slice(0);if(this.props.checkbox&&e.length&&e[0].type!="checkbox"){e.unshift({type:"checkbox",textAlign:"center",width:this.props.checkbox})}this._columnSize=e.length;return s.createElement("table",{style:this.props.style,className:"zr-table "+this.props.className,"data-fixed":this.props.fixed,cellPadding:"0",cellSpacing:"0"},s.createElement(o,i({},this.props,{items:e})),this.props.showHeader&&s.createElement(r,i({},this.props,{items:e,columnSize:this._columnSize,onCheckBoxChange:this.__onHeaderCheckBoxChange,onFilter:this.__onFilter})),s.createElement(a,i({ref:"body"},this.props,{items:e,columnSize:this._columnSize,onCheckBoxChange:this.__onBodyCheckBoxChange})))}})},285:function(t,e){},29:function(t,e,n){t.exports=zn.arrayValueToObject(["FilterItem","WebRouter","XlsxImporter"],function(t){return n(270)("./"+t+".js")})},30:function(t,e,n){t.exports=zn.arrayValueToObject(["Node","Link","FlowCanvas"],function(t){return n(277)("./"+t+".js")})},31:function(t,e,n){n(280);var s=n(0);var i=n(11);t.exports=s.createClass({displayName:"Node",getDefaultProps:function t(){return{draggable:true,editable:true,data:{},x:0,y:0}},getInitialState:function t(){this._links={};this._nodes={};return{uuid:this.props.id||zn.uuid(),highLight:false}},componentDidMount:function t(){var e=this._dom,n=this;this._x=this.props.x;this._y=this.props.y;this._parentPosition=zn.dom.getPosition(this._dom.parentNode);if(this.props.draggable){zn.react.Draggable.create(e,{start:[this.props.x,this.props.y],onDragStart:this.__onNodeDragStart,onDrag:this.__onNodeDrag,onDragEnd:this.__onNodeDragEnd})}zn.dom.on(e,"mouseover",this.__onMouseOver);zn.dom.on(e,"mouseout",this.__onMouseOut);this.props.onNodeDidMount&&this.props.onNodeDidMount(this)},getCenterXY:function t(){var e=zn.dom.getPosition(this._dom);var n=e.width/2,i=e.height/2,s=0,r=0;if(!this.props.draggable){s=e.x-this._parentPosition.x+n;r=e.y-this._parentPosition.y+i}else{s=this._x+n;r=this._y+i;if(this.props.parent){s=s+this.props.parent._x;r=r+this.props.parent._y}}return{x:s,y:r}},setLink:function t(e,n){this._links[e]=n},getLink:function t(e){return this._links[e]},deleteLink:function t(e){this._links[e]=null;delete this._links[e]},setNode:function t(e,n){this._nodes[e]=n},addNode:function t(e){var n=null,i;if(e){n=s.createElement(Node,e);this._nodes[n.state.uuid]=n;s.render(n,this._dom)}},__onNodeDragStart:function t(e,n){var i=this._dom;this._oldZIndex=i.style.zIndex;i.style.zIndex=10;this._startVector={x:n.mouseX,y:n.mouseY};if(e.target.className.indexOf("manual-connect")!=-1){return this.__createLine(e,n),false}},__createLine:function t(e,n){if(!this._dragTemp){var s=this;var r=this._dragTemp=document.createElement("div");r.className="zr-graph-node-line-temp";zn.dom.setStyles(this._dragTemp,{width:8,height:8,borderRadius:5,backgroundColor:"#800010"});var a=this.getCenterXY(),i=zn.dom.getPosition(e.target),o=this._parentPosition;var l=this.props.canvas.refs.temp;zn.react.Draggable.create(this._dragTemp,{event:e,start:[i.x,i.y],onDragStart:function t(e,n){},onDrag:function t(e,n){var i=zn.dom.getPosition(r);l.reset(a,{x:i.x-o.x,y:i.y-o.y})},onDragEnd:function t(e,n){s.clearTempLink();var i=s.findNode.call(s,document.elementFromPoint(n.mouseX,n.mouseY));if(i){if(i!==s.getId()){s.props.canvas.addLink(s.getId(),i)}}else{s.props.onNodeEditDragEnd&&s.props.onNodeEditDragEnd(s,n)}}});document.body.appendChild(this._dragTemp)}},findNode:function t(e){if(!e||e===document.body){return}var n=e.className;if(!n){return this.findNode(e.parentNode)}if(n=="zr-flow-canvas"){return}if(!n.indexOf){return}if(n.indexOf("zr-graph-node")!==-1){return e.getAttribute("data-id")}else{return this.findNode(e.parentNode)}},clearTempLink:function t(){if(this._dragTemp){document.body.removeChild(this._dragTemp);this._dragTemp=null}this.props.canvas.refs.temp.reset({x:0,y:0},{x:0,y:0})},__onConnectMouseUp:function t(){this.clearTempLink()},__onNodeDragEnd:function t(e,n){var i=Math.abs(this._startVector.x-n.mouseX),s=Math.abs(this._startVector.y-n.mouseY);if(this._dom){this._dom.style.zIndex=this._oldZIndex}if(i<5&&s<5){this.props.onClick&&this.props.onClick(e,this);return false}this.props.onNodeDragEnd&&this.props.onNodeDragEnd(e,n,this)},__onNodeDrag:function t(e,n){this._x=n.currX;this._y=n.currY;this.__onLinkReset();this.__scanChild();!!this.onNodeDrag&&this.onNodeDrag(e,n)},__onLinkReset:function t(){var e=this._links;for(var n in e){e[n].reset()}},__scanChild:function t(){var e=this._nodes;for(var n in e){e[n].__onLinkReset()}},highLight:function t(e){this.setState({highLight:e!==undefined?e:true})},__onMouseOver:function t(e){for(var n in this._links){this._links[n].highLight(true)}},__onMouseOut:function t(e){for(var n in this._links){this._links[n].highLight(false)}this.setState({highLight:false})},__editableRender:function t(){if(this.props.editable){return s.createElement("i",{className:"manual-connect",onMouseUp:this.__onConnectMouseUp})}},__onContextMenu:function t(e){e.stopPropagation();return this.props.onContextMenu&&this.props.onContextMenu(e,this)},getId:function t(){return this.state.uuid},render:function t(){var n=this;return s.createElement("div",{ref:function t(e){return n._dom=e},style:this.props.style,className:zn.react.classname("zr-graph-node",this.props.className),"data-id":this.getId(),"data-highlight":this.state.highLight,"data-selected":this.props.selected,onContextMenu:this.__onContextMenu},this.props.render&&this.props.render(this.props.data,this),this.__editableRender())}})},32:function(t,e,n){t.exports=zn.arrayValueToObject(["TableColgroup","TableFilter","TableRow","TableHeader","TableBody","Table","EditableTable"],function(t){return n(282)("./"+t+".js")})},33:function(t,e,n){function r(){r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){t[i]=n[i]}}}return t};return r.apply(this,arguments)}var a=n(0);var i=n(34);t.exports=a.createClass({displayName:"TableHeader",getInitialState:function t(){return{}},componentDidMount:function t(){},__onCheckBoxChange:function t(e,n,i){this.props.onCheckBoxChange&&this.props.onCheckBoxChange(n,this,i)},__onColClick:function t(e,n){this.props.onColClick&&this.props.onColClick(e,n)},__itemRender:function t(e,n){var i=this;var s=this.props.headerRender&&this.props.headerRender(e,n,this.props.columnSize);if(!s){switch(e.type){case"checkbox":s=a.createElement(zn.react.Checkbox,r({},e,{onChange:this.__onCheckBoxChange}));break;default:s=a.createElement("div",{onClick:function t(){return i.__onColClick(e,n)}},a.createElement("span",null,e.title||e.name),this.props.sort&&a.createElement("i",{className:"sort fa fa-arrows-v"}));break}}return a.createElement("th",{key:n,className:"text-align-"+(e.textAlign||"left"),style:{color:!!e.required?"#F44336":""}},s)},render:function t(){return a.createElement("thead",null,a.createElement("tr",{className:"table-row thead"},(this.props.items||[]).map(this.__itemRender)),this.props.enableFilter&&a.createElement(i,this.props))}})},34:function(t,e,n){function o(){o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){t[i]=n[i]}}}return t};return o.apply(this,arguments)}var l=n(0);t.exports=l.createClass({displayName:"TableFilter",getDefaultProps:function t(){return{filterData:{},onFilterSearch:function t(){}}},getInitialState:function t(){return{}},componentDidMount:function t(){this.search(this.props.filterData)},__onFilter:function t(){this.search(this.props.filterData)},search:function t(e){e&&this.props.onFilterSearch(e,this)},__onFilterChange:function t(e,n){if(this.props.filterData[n.name]){this.props.filterData[n.name].opt=e.value}else{this.props.filterData[n.name]={key:n.name,opt:e.value}}},__onFilterOptChange:function t(e,n){if(this.props.filterData[n]){this.props.filterData[n].opt=e}else{this.props.filterData[n]={key:n,opt:e}}this.props.onFilter&&this.props.onFilter(this.validate())},__onFilterItemChange:function t(e,n){this.props.onFilter&&this.props.onFilter(this.validate(),n)},validate:function t(){var e={},n=null;for(var i in this.refs){n=this.refs[i];if(n.state.opt){e[i.split("_convert")[0]]={opt:n.state.opt,value:n.validate()}}}return e},__onFilterItemCancle:function t(){this.props.onFilter&&this.props.onFilter(this.validate())},__itemRender:function t(n,e){var i=this;var s=null;switch(n.type){case"checkbox":s=l.createElement(zn.react.Icon,{icon:"fa-filter"});break;case"action":n.textAlign="center";s=l.createElement(zn.react.Icon,{onClick:this.__onFilter,icon:"fa-search"});break;default:if(n.filter){var r=zn.overwrite(n.filter||{},{type:"Input",fullWidth:true});var a={onChange:this.__onFilterItemChange};if(r.type=="Input"){a={onEnter:this.__onFilterItemChange}}s=l.createElement(zn.react.FilterItem,o({popoverWidth:80,opts:["like","="],name:n.name,ref:n.name},r,{onOptChange:function t(e){return i.__onFilterOptChange(e,n.name)},onCancle:this.__onFilterItemCancle},a))}else{s=null}break}return l.createElement("td",{key:e,className:"text-align-"+(n.textAlign||"left"),width:n.width?n.width:0},s)},render:function t(){return l.createElement("tr",{className:"table-row editable filter"},(this.props.items||[]).map(this.__itemRender))}})},35:function(t,e,n){function r(t){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){r=function t(e){return typeof e}}else{r=function t(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return r(t)}var a=n(0);var o=n(36);var i=a.createClass({displayName:"TableBody",getInitialState:function t(){return{curr:null,data:null,loading:false,value:this.props.value,values:[]}},componentDidMount:function t(){var e=this;if(this.props.data&&this.props.data.on){var n=this;this.props.data.on("before",function(){if(n.props.showLoading){zn.preloader.open({title:"加载中..."})}}).on("complete",function(){if(n.props.showLoading){zn.preloader.close()}})}this._dataSource=Store.dataSource(this.props.data,{autoLoad:this.props.autoLoad||true,onExec:function t(){return e.setState({loading:true})},onSuccess:function(t){this.__onDataLoaded(this.dataHandler(t));this.props.onData&&this.props.onData(t)}.bind(this)})},componentWillUnmount:function t(){},dataHandler:function t(e){if(this.props.dataHandler){return this.props.dataHandler(e)}return e.result||e},componentWillReceiveProps:function t(e){if(e.data!==this.props.data){this._dataSource.reset(e.data)}},request:function t(e,n){this._dataSource.reset(e,n)},refresh:function t(){this._dataSource.refresh()},setData:function t(e,n){this._dataSource.reset(e,n)},getData:function t(){return this.state.data},setValue:function t(e){if(this.props.editable){return this.setData(e)}else{return this.setState({value:e})}},getValue:function t(){if(this.props.editable){return this.getData()}else{return this.state.value}},insertRow:function t(e,n){if(n===undefined){this.state.data.push(e)}else{this.state.data.splice(n,0,e)}this.forceUpdate()},deleteRow:function t(e){this.state.data.splice(this.state.data.indexOf(e),1);this.forceUpdate()},filter:function t(e){this.setState({data:this.state.data.filter(e||function(){})})},search:function t(e){if(!this._data){this._data=this.state.data.slice(0)}this.setState({data:this._data.filter(e)})},checkedAll:function t(e){if(e){this.setState({value:this.state.values})}else{this.setState({value:[]})}},__onDataLoaded:function t(e){if(!this.isMounted()){return false}this.setState({data:e,loading:false});if(this.props.fireIndex!=undefined){this.fireClick(this.props.fireIndex)}this.props.onLoaded&&this.props.onLoaded(e,this)},fireClick:function t(e){},getSelectedRow:function t(){return this.state.curr},__onTableRowClick:function t(e,n,i){if(this.props.singleSelect){if(this.state.curr){this.state.curr.selected(false)}i.selected(true);this.state.curr=i}this.props.onTableRowClick&&this.props.onTableRowClick(e,n,i,this)},__onRowCheckBoxChange:function t(e,n,i){var s=n.props.data[this.props.valueKey];if(!!e){this.state.value.push(s)}else{this.state.value.splice(this.state.value.indexOf(s),1)}this.props.onCheckBoxChange&&this.props.onCheckBoxChange(e,n,i,this)},render:function t(){if(this.state.loading){return a.createElement("tbody",null,a.createElement("tr",{style:{position:"relative",height:180}},a.createElement("td",{style:{position:"absolute",width:"100%"}},a.createElement(zn.react.DataLoader,{style:{width:100},loader:"arrow-circle",content:"Loading ......"}))))}this.state.values=[];return a.createElement("tbody",{style:this.props.tbodyStyle},this.state.data&&this.state.data.map&&this.state.data.map(function(n,i){var s=this;var t=this.props.onRowRender&&this.props.onRowRender(n,i,this.state.data.length);if(t){return t}var e=n[this.props.valueKey];this.state.values.push(e);return r(n)==="object"?a.createElement(o,{index:i,key:i+"_"+zn.uuid(),data:n,style:this.props.rowStyleValidate&&this.props.rowStyleValidate(n,i,this.state.data.length),items:this.props.items,checked:this.state.value.indexOf(e)!=-1,editable:this.props.editable!==undefined?this.props.editable:n._editable,checkbox:this.props.checkbox,rowRender:this.props.rowRender,columnRender:this.props.columnRender,draggable:!!this.props.onRowDragStart,onDidMount:this.__onRowDidMount,onRowClick:this.__onTableRowClick,onDragStart:function t(e){return s.props.onRowDragStart(e,n,i)},onCheckBoxChange:this.__onRowCheckBoxChange,onRowColumnChange:this.props.onRowColumnChange}):null}.bind(this)))}});i.defaultProps={showLoading:true,singleSelect:true,rowStyleValidate:function t(){},value:[],valueKey:"id"};t.exports=i},36:function(t,e,n){function l(){l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){t[i]=n[i]}}}return t};return l.apply(this,arguments)}var h=n(0);var s=n(1);t.exports=h.createClass({displayName:"TableRow",getDefaultProps:function t(){return{checked:false}},getInitialState:function t(){return{selected:this.props.selected,editable:this.props.editable,checked:this.props.checked,data:this.props.data||{},vars:[],exps:{}}},componentDidMount:function t(){this.props.onDidMount&&this.props.onDidMount(this)},componentWillReceiveProps:function t(e){if(e.data!=this.props.data){this.state.data=e.data;this.forceUpdate()}},checked:function t(e){if(this.isMounted()){this.setState({checked:e})}},selected:function t(e){if(this.isMounted()){this.setState({selected:e})}},editable:function t(e){if(this.isMounted()){this.setState({editable:e})}},__onCheckBoxChange:function t(e,n,i){this.state.checked=n;this.props.onCheckBoxChange&&this.props.onCheckBoxChange(n,this,i)},__onRowClick:function t(e){var n=this.__getTargetTD(e.target),i=s.findDOMNode(this);this.props.onRowClick&&this.props.onRowClick(e,{tr:i,td:n,data:this.state.data,items:this.props.items},this)},__getTargetTD:function t(e){if(e.tagName!=="TD"){return this.__getTargetTD(e.parentNode)}else{return e}},__onTableColumnChange:function t(e,n,i,s,r,a){var o=a.onChange&&a.onChange(i,s,this,r,a,e,n);if(o!==undefined||o!==null){this.state.data[a.name]=s.getValue()}var l=[];this.state.vars.map(function(t,e){if(zn.is(this.state.data[t],"number")){l.push(t+" = "+(this.state.data[t]||0))}else{l.push(t+" = '"+(this.state.data[t]||"")+"'")}}.bind(this));l=l.join(",");Object.keys(this.state.exps).map(function(t,e){this.state.data[t]=eval.call(null,"(function () { var "+l+"; return "+this.state.exps[t]+"; })()")}.bind(this));this.props.onRowColumnChange&&this.props.onRowColumnChange(e,n,i,this.state.data,a);this.forceUpdate()},setRowValue:function t(e){switch(arguments.length){case 1:zn.overwrite(this.state.data,e);break;case 2:this.state.data[arguments[0]]=arguments[1];break}return this},getRowValue:function t(){if(arguments.length){return this.state.data[arguments[0]]}else{return this.state.data}},__columnRender:function t(s,r){var a=this;var e=this.state.data,n=null;if(s.type!="action"&&s.type!="checkbox"&&this.state.vars.indexOf(s.name)==-1){this.state.vars.push(s.name)}if(Object.prototype.toString.call(e)==="[object Array]"){if(this.props.checkbox){e=e[r-1]}else{e=e[r]}}else{e=this.state.data[s.convert||s.name];if(e==undefined){e=this.state.data[s.name]}}if(this.props.columnRender){n=this.props.columnRender(this.props.index,r,this.state.data,s,e)}if(n==null){var i=s.type;if(zn.is(i,"string")){if(i[0]=="{"&&i[i.length-1]=="}"){if(!this.state.exps[s.name]){this.state.exps[s.name]=i.substring(1,i.length-1)}n=h.createElement("span",{style:{padding:"0px 5px"}},e)}else{if(i=="checkbox"){e=e==undefined?this.props.checked:e;n=this.state.editable?h.createElement(zn.react.Icon,{icon:"fa-edit"}):h.createElement(zn.react.Checkbox,{onChange:this.__onCheckBoxChange,checked:e})}else{if(zn.path(window,i)){_input=zn.path(window,i)}else{_input=zn.react[i]}}}}else{_input=i}if(!n){var o=_input||zn.react.Input;if(s.props&&s.props[0]=="{"){s.attrs=JSON.parse(s.props)}n=h.createElement("span",null,e);if(this.state.editable){if(o==zn.react.Input){n=h.createElement(o,l({},s,{value:e,text:e,onBlur:function t(e,n,i){return a.__onTableColumnChange(a.props.index,r,e,n,i,s)}}))}else{n=h.createElement(o,l({},s,{value:e,text:e,onChange:function t(e,n,i){return a.__onTableColumnChange(a.props.index,r,e,n,i,s)}}))}}}}return h.createElement("td",{key:r,title:e,className:"text-align-"+(s.textAlign||"left")},n)},render:function t(){return h.createElement("tr",{style:this.props.style,className:"table-row "+(this.state.editable?"editable":"")+" "+(this.state.selected?"selected":""),onClick:this.__onRowClick},(this.props.items||[]).map(this.__columnRender))}})},37:function(t,e,n){var i=n(0);t.exports=i.createClass({displayName:"TableColgroup",render:function t(){return i.createElement("colgroup",null,(this.props.items||[]).map(function(t,e){return i.createElement("col",{key:e,style:{width:t.width}})}))}})}});